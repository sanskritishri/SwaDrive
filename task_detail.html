<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Available Tasks</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        /* ---------- Same CSS as before ---------- */
        :root {
            --primary: #4776E6;
            --primary-gradient: linear-gradient(135deg, #4776E6 0%, #8E54E9 100%);
            --secondary: #FF8C42;
            --text-dark: #2D3748;
            --text-light: #718096;
            --white: #ffffff;
            --off-white: #F7FAFC;
            --border-radius: 12px;
            --shadow: 0 10px 30px rgba(71, 118, 230, 0.1);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Poppins', sans-serif; background: var(--off-white); color: var(--text-dark); line-height: 1.6; }
        h1,h2,h3,h4 { font-family: 'Montserrat', sans-serif; font-weight: 700; line-height: 1.3; }

        /* Navbar & Buttons */
        .navbar { background: var(--white); padding: 15px 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; z-index: 100; }
        .logo { color: var(--text-dark); font-family: 'Montserrat', sans-serif; font-weight: 700; font-size: 1.5rem; text-decoration: none; display: flex; align-items: center; gap: 8px; }
        .logo span { background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .logo-icon { color: var(--primary); font-size: 1.5rem; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        .nav-link { color: var(--text-dark); text-decoration: none; font-weight: 500; transition: color 0.3s; font-size: 0.95rem; }
        .nav-link:hover { color: var(--primary); }
        .nav-link.active { color: var(--primary); font-weight: 600; }
        .nav-link.highlight { background: var(--primary-gradient); color: var(--white); padding: 8px 20px; border-radius: 50px; font-weight: 500; }
        .user-menu { display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .user-avatar { width: 35px; height: 35px; border-radius: 50%; background: var(--primary-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 0.9rem; }

        .container { width: 100%; max-width: 1000px; margin: 0 auto; padding: 30px 20px; }
        .breadcrumb { display: flex; align-items: center; gap: 8px; margin-bottom: 20px; font-size: 0.9rem; }
        .breadcrumb a { color: var(--text-light); text-decoration: none; transition: color 0.3s; }
        .breadcrumb a:hover { color: var(--primary); }
        .breadcrumb .separator { color: var(--text-light); }
        .breadcrumb .current { color: var(--text-dark); font-weight: 500; }

        /* Task Card */
        .task-detail-card { background: var(--white); border-radius: var(--border-radius); box-shadow: var(--shadow); overflow: hidden; margin-bottom: 30px; }
        .task-detail-header { padding: 25px 30px; background: var(--primary-gradient); color: var(--white); display: flex; justify-content: space-between; align-items: center; }
        .task-detail-title { font-size: 1.5rem; margin: 0; }
        .task-status { padding: 6px 16px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; background-color: rgba(255,255,255,0.2); }

        .task-detail-content { padding: 30px; }
        .task-detail-section { margin-bottom: 25px; }
        .section-title { font-size: 1.1rem; margin-bottom: 15px; color: var(--text-dark); display: flex; align-items: center; gap: 10px; }
        .section-title i { color: var(--primary); }
        .detail-row { display: flex; margin-bottom: 12px; }
        .detail-label { min-width: 150px; font-weight: 500; color: var(--text-light); }
        .detail-value { color: var(--text-dark); flex: 1; }
        .task-description { background-color: var(--off-white); padding: 20px; border-radius: 8px; margin-bottom: 10px; }
        .map-container { height: 250px; border-radius: 8px; overflow: hidden; margin-bottom: 20px; }
        .special-instructions { background-color: rgba(71, 118, 230, 0.05); padding: 20px; border-radius: 8px; border-left: 4px solid var(--primary); }
        .action-buttons { display: flex; gap: 15px; margin-top: 30px; }
        .btn { padding: 12px 24px; border: none; border-radius: 50px; font-weight: 600; font-size: 0.9rem; cursor: pointer; display: flex; align-items: center; gap: 8px; }
        .btn-primary { background: var(--primary-gradient); color: var(--white); }
        .btn-secondary { background: var(--white); color: var(--text-dark); border: 1px solid rgba(0,0,0,0.1); }
        .task-requester { display: flex; align-items: center; gap: 15px; padding: 20px; background-color: var(--off-white); border-radius: 8px; }
        .requester-avatar { width: 50px; height: 50px; border-radius: 50%; background: var(--primary-gradient); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 1.1rem; }
        .requester-info { flex: 1; }
        .requester-name { font-weight: 600; margin-bottom: 3px; }
        .requester-rating { display: flex; align-items: center; gap: 5px; color: var(--secondary); font-size: 0.9rem; }
        .requester-meta { font-size: 0.85rem; color: var(--text-light); }
        .section-divider { height: 1px; background-color: rgba(0,0,0,0.05); margin: 30px 0; }
        .related-tasks { margin-top: 40px; }
        .related-tasks-title { font-size: 1.3rem; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .related-tasks-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .related-task-card { background: var(--white); border-radius: var(--border-radius); box-shadow: var(--shadow); padding: 15px; text-decoration: none; color: inherit; }
        .related-task-card:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(71, 118, 230, 0.15); }
        .related-task-title { font-size: 1rem; margin-bottom: 10px; }
        .related-task-meta { display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--text-light); }
        .task-image { width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin-bottom: 20px; }
    </style>
</head>
<body>
<nav class="navbar">
    <a href="/" class="logo"><i class="fas fa-route logo-icon"></i> Swa<span>Drive</span></a>
    <div class="nav-links">
        <a href="/Home.html" class="nav-link">Home</a>
        <a href="/task_detail.html" class="nav-link active">Find Tasks</a>
        <a href="/d1.html" class="nav-link">List a Need</a>
        <a href="/Home.html" class="nav-link">How It Works</a>
        <a href="/tasks.html" class="nav-link highlight"><i class="fas fa-plus"></i> List Task</a>
    </div>
    <div class="user-menu"><div class="user-avatar">KS</div><i class="fas fa-chevron-down" style="font-size:0.7rem;color:var(--text-light)"></i></div>
</nav>

<div class="container">
    <div class="breadcrumb">
        <a href="/Home.html">Home</a><span class="separator"><i class="fas fa-chevron-right"></i></span>
        <a href="/tasks.html">Available Tasks</a><span class="separator"><i class="fas fa-chevron-right"></i></span>
        <span class="current">All Tasks</span>
    </div>

    <div id="task-list"></div>
</div>

<script>
const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
const taskList = document.getElementById("task-list");

function renderTasks() {
    taskList.innerHTML = "";
    if(tasks.length===0){ taskList.innerHTML="<p>No tasks found!</p>"; return; }

    tasks.forEach((task,index)=>{
        const card=document.createElement("div");
        card.classList.add("task-detail-card");
        card.innerHTML=`
        <div class="task-detail-header">
            <h1 class="task-detail-title">Task #${index+1} - ${task.category}</h1>
            <div class="task-status">${task.urgency || "Pending"}</div>
        </div>
        <div class="task-detail-content">
            ${task.photos && task.photos.length>0 ? `<img src="${task.photos[0]}" class="task-image">` : ""}
            <div class="task-detail-section">
                <h3 class="section-title"><i class="fas fa-info-circle"></i> Task Details</h3>
                <div class="detail-row"><div class="detail-label">Component</div><div class="detail-value">${task.component}</div></div>
                <div class="detail-row"><div class="detail-label">Problem</div><div class="detail-value">${task.mechanicProblem}</div></div>
                <div class="detail-row"><div class="detail-label">Date</div><div class="detail-value">${task.date}</div></div>
                <div class="detail-row"><div class="detail-label">Time</div><div class="detail-value">${task.time}</div></div>
                <div class="detail-row"><div class="detail-label">contact</div><div class="detail-value">${task.contact}</div></div>
                <div class="detail-row"><div class="detail-label">Special Instructions</div><div class="detail-value">${task.specialInstructions||"None"}</div></div>
            </div>

            <div class="section-divider"></div>

            <div class="task-detail-section">
                <h3 class="section-title"><i class="fas fa-align-left"></i> Description</h3>
                <div class="task-description">${task.description}</div>
            </div>

            <div class="task-detail-section">
                <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> Location</h3>
                <div class="map-container">
                    <iframe src="https://www.google.com/maps?q=${task.latitude},${task.longitude}&output=embed" style="border:0;width:100%;height:100%;" allowfullscreen="" loading="lazy"></iframe>
                </div>
                <div class="detail-row"><div class="detail-label">Address</div><div class="detail-value">${task.location}</div></div>
            </div>

            <!-- Task Requester Section -->
            <div class="section-divider"></div>
            <div class="task-detail-section">
                <h3 class="section-title"><i class="fas fa-user"></i> Task Requester</h3>
                <div class="task-requester">
                    <div class="requester-avatar">${task.requesterInitials || "NA"}</div>
                    <div class="requester-info">
                        <div class="requester-name">${task.requesterName || "Anonymous"}</div>
                        <div class="requester-rating">
                            <i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <i class="fas fa-star"></i><i class="fas fa-star"></i>
                            <i class="fas fa-star-half-alt"></i>
                            <span>${task.requesterRating || "0"}</span>
                        </div>
                        <div class="requester-meta">Member since ${task.requesterJoined || "N/A"}</div>
                    </div>
                    <button class="btn btn-secondary contact-button"><i class="fas fa-comment"></i> Contact</button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn btn-secondary" onclick="window.history.back()"><i class="fas fa-arrow-left"></i> Back</button>
                <button class="btn btn-primary" onclick="acceptTask(${index})"><i class="fas fa-check"></i> Accept</button>
                <button class="btn btn-secondary" onclick="deleteTask(${index})"><i class="fas fa-trash"></i> Delete</button>
            </div>
        </div>
        `;
        taskList.appendChild(card);
    });
}

// Delete task function
function deleteTask(index){
    if(confirm("Are you sure you want to delete this task?")){
        tasks.splice(index,1);
        localStorage.setItem("tasks", JSON.stringify(tasks));
        renderTasks();
    }
}

// Accept task function (with alert)
function acceptTask(index){
    alert("âœ… You have accepted: " + tasks[index].category);
}

renderTasks();
</script>
</body>
</html>

